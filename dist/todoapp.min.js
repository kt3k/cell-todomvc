var e,t="readystatechange";var o=e=>`color: ${e}; font-weight: bold;`,n="#f012be";function l({component:e,e:t,module:l,color:s}){if("boolean"==typeof __DEV__&&!__DEV__)return;const c=t.type;console.groupCollapsed(`${l}> %c${c}%c on %c${e}`,o(s||n),"",o("#1a80cc")),console.log(t),t.target&&console.log(t.target),console.groupEnd()}var s={};function c(e,t){if(!e)throw new Error(t)}function i(e,t,o,n,s){c("function"==typeof n,`Event handler must be a function, ${typeof n} (${n}) is given`);const i=o=>{s&&![].some.call(t.querySelectorAll(s),(e=>e===o.target||e.contains(o.target)))||(l({module:"ðŸ’Š",color:"#e0407b",e:o,component:e}),n(o))};t.addEventListener(`__unmount__:${e}`,(()=>{t.removeEventListener(o,i)}),{once:!0}),t.addEventListener(o,i)}var r=class{constructor(e,t,o){this.id=e,this.title=t,this.completed=o}toggle(){this.completed=!this.completed}},d="cell-todomvc",a=class e{constructor(e=[]){this.todos=e}getById(e){return this.todos.find((t=>t.id===e))}remove(e){this.todos=this.todos.filter((t=>t.id!==e.id))}add(e){this.todos.push(e)}get length(){return this.todos.length}has(e){return this.todos.some((t=>t.id===e.id))}completed(){return new e(this.todos.filter((e=>e.completed)))}uncompleted(){return new e(this.todos.filter((e=>!e.completed)))}completeAll(){this.todos.forEach((e=>{e.completed=!0}))}uncompleteAll(){this.todos.forEach((e=>{e.completed=!1}))}forEach(e){this.todos.forEach(e)}toJSON(){return JSON.stringify(this.todos)}static fromJson(t){return new e(JSON.parse(t).map((({id:e,title:t,completed:o})=>new r(e,t,o))))}save(){localStorage.setItem(d,this.toJSON())}static restore(){return e.fromJson(localStorage.getItem(d)||"[]")}maxId(){return Math.max(0,...this.todos.map((e=>+e.id)))}},g=0,m="all";!function(o,n){c("string"==typeof n&&!!n,"Component name must be a non-empty string"),c(!s[n],`The component of the given name is already registered: ${n}`);const r=`${n}-ðŸ’Š`,d=e=>{if(!e.classList.contains(r)){e.classList.add(n),e.classList.add(r),e.addEventListener(`__ummount__:${n}`,(()=>{e.classList.remove(r)}),{once:!0});const t=new Proxy((()=>{}),{set:(t,o,l)=>(i(n,e,o,l),!0),get:(t,o)=>"outside"===o?new Proxy({},{set(t,o,s){c("function"==typeof s,`Event handler must be a function, ${typeof s} (${s}) is given`);const i=t=>{e===t.target||e.contains(t.target)||(l({module:"outside",color:"#39cccc",e:t,component:n}),s(t))};return document.addEventListener(o,i),e.addEventListener(`__unmount__:${n}`,(()=>{document.removeEventListener(o,i)}),{once:!0}),!0}}):null,apply(t,o,l){const s=l[0];return c("string"==typeof s,"Delegation selector must be a string. ${typeof selector} is given."),new Proxy({},{set:(t,o,l)=>(i(n,e,o,l,s),!0)})}}),s=t=>e.classList.add(`sub:${t}`),d=o({el:e,on:t,pub:(e,t)=>{document.querySelectorAll(`.sub\\:${e}`).forEach((o=>{o.dispatchEvent(new CustomEvent(e,{bubbles:!1,detail:t}))}))},sub:s,query:t=>e.querySelector(t),queryAll:t=>e.querySelectorAll(t)});"string"==typeof d&&(e.innerHTML=d)}};d.sel=`.${n}:not(.${r})`,s[n]=d,(e=e||new Promise((e=>{const o=document,n=()=>{"complete"===o.readyState&&(e(),o.removeEventListener(t,n))};o.addEventListener(t,n),n()}))).then((()=>{!function(e,t){let o;e?(!function(e){c("string"==typeof e,"The name should be a string"),c(!!s[e],`The component of the given name is not registered: ${e}`)}(e),o=[e]):o=Object.keys(s);o.map((e=>{[].map.call((t||document).querySelectorAll(s[e].sel),s[e])}))}(n)}))}((function({el:e,on:t,query:o}){e.dataset.framework="cell";const n=a.restore();function l(){const{hash:e}=location;m="#/active"===e?"uncompleted":"#/completed"===e?"completed":"all",o('a[href="#/all"]').classList.toggle("selected","all"===m),o('a[href="#/active"]').classList.toggle("selected","uncompleted"===m),o('a[href="#/completed"]').classList.toggle("selected","completed"===m),s()}function s(){n.save();const e=n.uncompleted(),t=n.completed(),l=o(".todo-list");if(o(".todo-count strong").textContent=`${e.length}`,o(".todo-count .plural").classList.toggle("hidden",1===e.length),o(".main").classList.toggle("hidden",0===n.length),o(".footer").classList.toggle("hidden",0===n.length),o(".toggle-all").classList.toggle("hidden",0===n.length),o('label[for="toggle-all"]').classList.toggle("hidden",0===n.length),o(".toggle-all").checked=0===e.length,o(".clear-completed").classList.toggle("hidden",0===t.length),"all"===m&&n.length===l.children.length)n.forEach((e=>{const t=l.querySelector(`[id="${e.id}"]`);t.classList.toggle("completed",e.completed),t.querySelector("label").textContent=e.title,t.querySelector(".toggle").checked=e.completed}));else{const o="uncompleted"===m?e:"completed"===m?t:n;l.innerHTML="",o.forEach((e=>{const t=document.createElement("li");t.innerHTML=`\n        <div class="view">\n          <input class="toggle" type="checkbox" ${e.completed?"checked":""}/>\n          <label>${e.title}</label>\n          <button class="destroy"></button>\n        </div>\n        <input class="edit" type="text" />\n      `,t.id=e.id,t.classList.add("todo"),t.classList.toggle("completed",e.completed),l.appendChild(t)}))}}g=n.maxId()+1,globalThis.onhashchange=()=>{l()},l(),o(".new-todo").focus(),s(),t(".new-todo").keypress=e=>{if(13!==e.which)return;const t=o(".new-todo"),l=o(".new-todo")?.value?.trim();l&&(t.value="",n.add(new r(""+g++,l,!1)),s())},t(".toggle").click=e=>{n.getById(e.target.parentElement.parentElement.id)?.toggle(),s()},t(".toggle-all").click=e=>{e.target.checked?n.completeAll():n.uncompleteAll(),s()},t(".destroy").click=e=>{const t=n.getById(e.target.parentElement.parentElement.id);n.remove(t),s()},t(".clear-completed").click=()=>{n.completed().forEach((e=>{n.remove(e)})),s()},t(".todo > .view > label").dblclick=e=>{const t=e.target.parentElement.parentElement,o=n.getById(t.id);t.classList.add("editing");const l=t.querySelector(".edit");l.value=o.title,l.focus()},t(".edit").keypress=t(".edit").keydown=e=>{const t=e.target;13===e.which?t.blur():27===e.which&&(t.value=n.getById(t.parentElement.id).title,t.blur())},t(".edit").focusout=e=>{const t=e.target,o=t.value.trim(),l=t.parentElement;o?(n.getById(l.id).title=o,l.classList.remove("editing")):(n.remove(n.getById(l.id)),l.classList.remove("editing")),s()}}
/*! Cell v0.1.3 | Copyright 2024 Yoshiya Hinosawa and Capsule contributors | MIT license */),"todoapp");