var e,t="readystatechange";var o=e=>`color: ${e}; font-weight: bold;`,n="#f012be";function l({component:e,e:t,module:l,color:s}){if("boolean"==typeof __DEV__&&!__DEV__)return;const c=t.type;"object"==typeof DEBUG_IGNORE&&DEBUG_IGNORE?.has(c)||(console.groupCollapsed(`${l}> %c${c}%c on %c${e}`,o(s||n),"",o("#1a80cc")),console.log(t),t.target&&console.log(t.target),console.groupEnd())}var s={};function c(e,t){if(!e)throw new Error(t)}function i(e){c("function"==typeof e,`Cannot add an event listener: The event handler must be a function, ${typeof e} (${e}) is given`)}function d(e){c("string"==typeof e,`Cannot add an event listener: The event type must be a string, ${typeof e} (${e}) is given`)}function r(e,t){let o;e?(!function(e){c("string"==typeof e,"The name should be a string"),c(!!s[e],`The component of the given name is not registered: ${e}`)}(e),o=[e]):o=Object.keys(s),o.map((e=>{[].map.call((t||document).querySelectorAll(s[e].sel),s[e])}))}var a=class{constructor(e,t,o){this.id=e,this.title=t,this.completed=o}toggle(){this.completed=!this.completed}},g="cell-todomvc",m=class e{constructor(e=[]){this.todos=e}getById(e){return this.todos.find((t=>t.id===e))}remove(e){this.todos=this.todos.filter((t=>t.id!==e.id))}add(e){this.todos.push(e)}get length(){return this.todos.length}has(e){return this.todos.some((t=>t.id===e.id))}completed(){return new e(this.todos.filter((e=>e.completed)))}uncompleted(){return new e(this.todos.filter((e=>!e.completed)))}completeAll(){this.todos.forEach((e=>{e.completed=!0}))}uncompleteAll(){this.todos.forEach((e=>{e.completed=!1}))}forEach(e){this.todos.forEach(e)}toJSON(){return JSON.stringify(this.todos)}static fromJson(t){return new e(JSON.parse(t).map((({id:e,title:t,completed:o})=>new a(e,t,o))))}save(){localStorage.setItem(g,this.toJSON())}static restore(){return e.fromJson(localStorage.getItem(g)||"[]")}maxId(){return Math.max(0,...this.todos.map((e=>+e.id)))}};!function(o,n){c("string"==typeof n&&!!n,"Component name must be a non-empty string"),c(!s[n],`The component of the given name is already registered: ${n}`);const a=`${n}-ðŸ’Š`,g=e=>{if(!e.classList.contains(a)){e.classList.add(n),e.classList.add(a),e.addEventListener(`__unmount__:${n}`,(()=>{e.classList.remove(a)}),{once:!0});const t=(t,o,s,c)=>{if("function"==typeof o?(c=o,o=void 0,s=void 0):"function"==typeof s&&"string"==typeof o?(c=s,s=void 0):"function"==typeof s&&"object"==typeof o&&(c=s,s=o,o=void 0),"function"!=typeof c)throw new Error(`Cannot add event listener: The handler must be a function, but ${typeof c} is given`);!function(e,t,o,n,s,c){d(o),i(n);const r=o=>{s&&![].some.call(t.querySelectorAll(s),(e=>e===o.target||e.contains(o.target)))||(l({module:"ðŸ’Š",color:"#e0407b",e:o,component:e}),n(o))};t.addEventListener(`__unmount__:${e}`,(()=>{t.removeEventListener(o,r,c)}),{once:!0}),t.addEventListener(o,r,c)}(n,e,t,c,o,s)},s=(t,o)=>{d(t),i(o);const s=t=>{e===t.target||e.contains(t.target)||(l({module:"outside",color:"#39cccc",e:t,component:n}),o(t))};document.addEventListener(t,s),e.addEventListener(`__unmount__:${n}`,(()=>{document.removeEventListener(t,s)}),{once:!0})},c=o({el:e,on:t,onOutside:s,query:t=>e.querySelector(t),queryAll:t=>e.querySelectorAll(t)});"string"==typeof c?e.innerHTML=c:c&&"function"==typeof c.then&&c.then((t=>{"string"==typeof t&&(e.innerHTML=t)}))}};g.sel=`.${n}:not(.${a})`,s[n]=g,"complete"===document.readyState?r():function(o=document){return e??=new Promise((e=>{const n=()=>{"complete"===o.readyState&&(e(),o.removeEventListener(t,n))};o.addEventListener(t,n),n()})),e}().then((()=>{r(n)}))}((function({el:e,on:t,query:o}){e.dataset.framework="cell";const n=m.restore();let l=n.maxId()+1,s="all";globalThis.onhashchange=()=>{i()},i(),o(".new-todo").focus(),d(),t("keypress",".new-todo",(e=>{if(13!==e.which)return;const t=o(".new-todo"),s=o(".new-todo")?.value?.trim();s&&(t.value="",n.add(new a(""+l++,s,!1)),d())})),t("click",".toggle",(e=>{n.getById(e.target.parentElement.parentElement.id)?.toggle(),d()})),t("click",".toggle-all",(e=>{e.target.checked?n.completeAll():n.uncompleteAll(),d()})),t("click",".destroy",(e=>{const t=n.getById(e.target.parentElement.parentElement.id);n.remove(t),d()})),t("click",".clear-completed",(()=>{n.completed().forEach((e=>{n.remove(e)})),d()})),t("dblclick",".todo > .view > label",(e=>{const t=e.target.parentElement.parentElement,o=n.getById(t.id);t.classList.add("editing");const l=t.querySelector(".edit");l.value=o.title,l.focus()}));const c=e=>{const t=e.target;13===e.which?t.blur():27===e.which&&(t.value=n.getById(t.parentElement.id).title,t.blur())};function i(){const{hash:e}=location;s="#/active"===e?"uncompleted":"#/completed"===e?"completed":"all",o('a[href="#/all"]').classList.toggle("selected","all"===s),o('a[href="#/active"]').classList.toggle("selected","uncompleted"===s),o('a[href="#/completed"]').classList.toggle("selected","completed"===s),d()}function d(){n.save();const e=n.uncompleted(),t=n.completed(),l=o(".todo-list");if(o(".todo-count strong").textContent=`${e.length}`,o(".todo-count .plural").classList.toggle("hidden",1===e.length),o(".main").classList.toggle("hidden",0===n.length),o(".footer").classList.toggle("hidden",0===n.length),o(".toggle-all").classList.toggle("hidden",0===n.length),o('label[for="toggle-all"]').classList.toggle("hidden",0===n.length),o(".toggle-all").checked=0===e.length,o(".clear-completed").classList.toggle("hidden",0===t.length),"all"===s&&n.length===l.children.length)n.forEach((e=>{const t=l.querySelector(`[id="${e.id}"]`);t.classList.toggle("completed",e.completed),t.querySelector("label").textContent=e.title,t.querySelector(".toggle").checked=e.completed}));else{const o="uncompleted"===s?e:"completed"===s?t:n;l.innerHTML="",o.forEach((e=>{const t=document.createElement("li");t.innerHTML=`\n        <div class="view">\n          <input class="toggle" type="checkbox" ${e.completed?"checked":""}/>\n          <label>${e.title}</label>\n          <button class="destroy"></button>\n        </div>\n        <input class="edit" type="text" />\n      `,t.id=e.id,t.classList.add("todo"),t.classList.toggle("completed",e.completed),l.appendChild(t)}))}}t("keypress",".edit",c),t("keydown",".edit",c),t("focusout",".edit",(e=>{const t=e.target,o=t.value.trim(),l=t.parentElement;o?(n.getById(l.id).title=o,l.classList.remove("editing")):(n.remove(n.getById(l.id)),l.classList.remove("editing")),d()}))}
/*! Cell v0.3.6 | Copyright 2024 Yoshiya Hinosawa and Capsule contributors | MIT license */),"todoapp");